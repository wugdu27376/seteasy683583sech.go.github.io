<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>搜索Easy V6.6</title>
    
<link rel="icon" href="https://wugdu27376.github.io/seteasy683583sech.go.github.io/favicon.ico">

<p><strong>

<body>
<a href="javascript:void(0)" id="85727544071588039023" style="font-size: 30px;">Baidu.com</a>
</body>

</strong>
    <style>
        body {
            margin: 0;
            padding: 20px;
            text-align: center;
            font-family: Arial, sans-serif;
        }
        
        .search-container {
            max-width: 800px;
            margin: 0 auto;
            display: flex; /* 使用flex布局让输入框和按钮同行 */
        }
        
        #engineSelect {
            min-width: 75px;
            width: 15%;
            max-width: 15%;
            user-select: none;
        }
        
        #urlInput {
            flex: 1; /* 输入框占据剩余空间 */
            min-width: 5%;
        }
        
        #submitBtn {
            margin-left: 3px; /* 按钮与输入框间距 */
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }
        
        #autoFillhttps input[type="checkbox"] {
            margin: 0; /* 移除默认外边距 */
            vertical-align: middle; /* 垂直对齐 */
        }

        #autoFillhttps label {
            margin: 0; /* 移除默认外边距 */
            vertical-align: middle; /* 垂直对齐 */
            margin-right: 7px;
        }
        
        #quickInputBtn button {
            margin-top: 3px;
            margin-bottom: 3px;
        }
        
        #linkNameValue, #linkColorValue {
            display: inline-block;
            max-width: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            vertical-align: bottom;
            margin-bottom: 2.3px;
        }
        #colorValue {
            display: inline-block;
            max-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin-bottom: -4.1px;
        }
        
        @media (min-width: 768px) {
            #quickLinks {
                width: 80%;
                left: 0;
                right: 0;
                margin: 0 auto;
            }
        }
    </style>
</head>
<body>
    <div class="search-container" id="searchContainer">
        <select id="engineSelect" style="height: 24px;">
        <optgroup label="搜索引擎">
            <option value="baidu">百度</option>
            <option value="google">谷歌</option>
            <option value="bing">必应</option>
            <option value="sogou">搜狗</option>
            <option value="so">360搜索</option>
            <option value="yandex">Yandex</option>
            <option value="duckduckgo">DuckDuckGo</option>
            <optgroup label="网页">
            <option value="autofillHttp1">Http网页</option>
            <option value="autofillHttps">Https网页</option>
            <option value="newtabpageHttp1">新建标签页(Http)</option>
            <option value="newtabpageHttps">新建标签页(Https)</option>
            <optgroup label="手机搜索">
            <option value="sodouyinM" id="douyinOption">抖音搜索</option>
            <option value="yzmsmM" id="shenmaOption">神马搜索</option>
            <option value="sotoutiaoM" id="toutiaoOption">头条搜索</option>
            <option value="baiduMEasy" id="baidueasyOption">百度精简版</option>
            <optgroup label="AI搜索">
            <option value="metasosuoAI">秘塔搜索</option>
            <option value="baiduAI">百度AI</option>
            <option value="360namisoAI">360纳米AI</option>
            <option value="zhihuZhiDaAI">知乎直答(需登录)</option>
            <option value="quarkpcAI" id="quarkaiOption">夸克AI(需登录)</option>
            <optgroup label="快捷翻译">
            <option value="googleTranslate">谷歌翻译</option>
            <option value="mcTranslator">必应翻译</option>
            <option value="yandexTranslate">Yandex翻译</option>
            <option value="sogouFanyi">搜狗翻译</option>
            <option value="oldBaiduFanyi" id="baiduFanyi">百度翻译</option>
            <option value="fanyiSo">360翻译</option>
            <option value="deeplTranslator">Deepl翻译</option>
            <option value="volcTranslate">火山翻译</option>
            <option value="nowTsAi">在线翻译</option>
            <option value="youdaoFanyi">有道词典</option>
            <optgroup label="其他">
            <option value="githubCode">Github</option>
            <option value="baiduTw" id="baidutwOption">Baidu</option>
            <option value="biliTv" id="bilibiliOption">BiliBili</option>
            <option value="kfBaidu">开发者搜索</option>
            <option value="iFrameFree">IFrame</option>
            <option value="showCheckbox">工具</option>
            <option value="customSearch">自定义</option>
        </select>
        <input type="search" id="urlInput" placeholder="输入网址" style="height: 24px;">
        <input type="submit" style="height: 24px;" value="跳转" id="submitBtn">
    </div>
    
    <div id="autoFillhttps" style="display: none; text-align: center; margin-top: 10px;">
        <input type="checkbox" id="customCheckbox">
            <label for="customCheckbox" style="user-select: none;">自动填充Https</label>
        <input type="checkbox" id="focusCheckbox">
            <label for="focusCheckbox" style="user-select: none;">输入时聚焦</label>
            <br/>
        <input type="checkbox" id="layoutCheckbox">
            <label for="layoutCheckbox" style="user-select: none;">居中布局</label>
        <input type="checkbox" id="showLinkCheckbox" checked>
            <label for="showLinkCheckbox" style="user-select: none;">显示推广链接</label>
            <br/>
        <input type="checkbox" id="showSendCheckbox" checked>
            <label for="showSendCheckbox" style="user-select: none;">显示搜索按钮</label>
        <input type="text" id="bgColorPicker" style="display: none;">
            <label for="bgColorPicker" style="user-select: none; vertical-align: middle; cursor: pointer;">背景颜色: <span id="colorValue">#ffffff</span></label>
            <br/>
        <input type="checkbox" id="quickInputCheckbox" disabled>
            <label for="quickInputCheckbox" style="user-select: none;">显示快捷输入</label>
            <input type="text" id="linkColorPicker" style="display: none;">
            <label for="linkColorPicker" style="user-select: none; vertical-align: middle; cursor: pointer;">链接颜色: <span id="linkColorValue">#0000ee</span></label>
            <br/>
            <label for="renameLinkBtn" style="user-select: none; vertical-align: middle; cursor: pointer;">链接名称: <span id="linkNameValue">Baidu.com</span></label>
            <label for="resetLinkColorBtn" style="user-select: none; vertical-align: middle; cursor: pointer;">重置链接样式</label>
            <input type="submit" id="resetLinkColorBtn" style="display: none;">
            <br/>
            <label for="heightPicker" style="user-select: none; vertical-align: middle; cursor: pointer;">搜索框高度: <span id="heightValue">24px</span></label>
            <label for="widthPicker" style="user-select: none; vertical-align: middle; cursor: pointer;">按钮宽度: <span id="widthValue">Default</span></label>
            <br/>
            <label for="redefineSearchBtn" style="user-select: none; vertical-align: middle; cursor: pointer;">重新自定义搜索</label>
            <input type="checkbox" id="saveInputCheckbox">
            <label for="saveInputCheckbox" style="user-select: none;">保留输入文本</label>
            <br/>
            <span style="margin-left: 3px;">
            <input type="checkbox" id="selectHttpsText" disabled>
            <label for="selectHttpsText" style="user-select: none;">自动选择文本</label>
            </span>
            <label style="user-select: none; margin-left: -3px;">用户设置: </label>
            <label for="importSettingsBtn" style="user-select: none; vertical-align: middle; margin-left: -5px; cursor: pointer;">导入</label>
            <input type="file" id="importSettingsInput" accept=".json" style="display: none;">
            <label for="exportSettingsBtn" style="user-select: none; vertical-align: middle; margin-left: -7px; cursor: pointer;">导出</label>
            <br/>
            <label style="user-select: none; margin-right: 0;">超链接:</label>
            <span id="linkCreatorBtn">
            <label for="linkCreatorBtn0" style="user-select: none; margin-right: 0; vertical-align: middle; cursor: pointer;">新建</label>
            </span>
            <label for="importLinksBtn" style="user-select: none; margin-right: 0; vertical-align: middle; cursor: pointer;">导入</label>
            <label for="exportLinksBtn" style="user-select: none; margin-right: 0; vertical-align: middle; cursor: pointer;">导出</label>
            <label for="clearLinksBtn" style="user-select: none; margin-right: 0; vertical-align: middle; cursor: pointer;">清空</label>
            <input type="file" id="importFileInput" accept=".html" style="display: none;">
        <div id="linkCreatorPanel" style="display: none; margin-top: 10px; margin-bottom: -20px;">
            <input type="text" id="linkUrlInput" value="https://baidu.com" placeholder="输入URL" style="width: 200px;">
            <input type="text" id="linkTextInput" value="快捷方式" placeholder="输入链接文本" style="width: 150px;">
            <label for="cancelLinkBtn" style="user-select: none; margin-right: 0; vertical-align: middle; cursor: pointer;">Cancel</label>
            <label for="createLinkBtn" style="user-select: none; vertical-align: middle; margin-left: 5px; cursor: pointer;">Create</label>
        </div>
        <br/>
        <div style="margin-top: 10px;">
            <span id="browserInfo" style="user-select: none;"></span>
        </div>
    </div>
    
    <div id="quickLinks" style="margin-top: 10px; margin-bottom: 20px;"></div>
    <div style="height: 5px;"></div>
    
    <div id="iframeContainer" style="display: none; width: 100%; height: 600px; margin-top: 10px;">
        <iframe id="webFrame" src="about:blank" style="width: 100%; height: calc(100% - 30px); border: 1px solid #ccc;"></iframe>
        <div style="margin-top: 10px; margin-bottom: -20px;">
            <label for="iframeRefreshBtn" style="user-select: none; vertical-align: middle; margin-left: 0; cursor: pointer; font-size: 17px;">刷新</label>
            <label for="iframeCloseBtn" style="user-select: none; vertical-align: middle; margin-left: 0; cursor: pointer; font-size: 17px;">关闭</label>
            <label for="resizeIframeWidthBtn" style="user-select: none; vertical-align: middle; margin-left: 0; cursor: pointer; font-size: 17px;">宽度</label>
            <label for="resizeIframeHeightBtn" style="user-select: none; vertical-align: middle; margin-left: 0; cursor: pointer; font-size: 17px;">高度</label>
            <br/>
            <div style="height: 10px;"></div>
        </div>
    </div>
    
    <div id="quickInputUi" style="display: none;">
    <div id="quickInputBtn" style="display: none;">
    <div id="quickInputBtn1Head">
        <button><span style="user-select: none;">https://</span></button>
        <button><span style="user-select: none;">blog.</span></button>
        <button><span style="user-select: none;">m.</span></button>
        <button><span style="user-select: none;">www.</span></button>
        <button><span style="user-select: none;">.com</span></button>
        <button><span style="user-select: none;">.cn</span></button>
        <button><span style="user-select: none;">.net</span></button>
        </div>
        <br/>
        <div id="quickInputBtn2">
            <button id="pos_minusInf"><span style="user-select: none;">-Inf</span></button>
            <button id="pos_minus10"><span style="user-select: none;">-10</span></button>
            <button id="pos_minus1"><span style="user-select: none;">-1</span></button>
            <button id="pos_plus1"><span style="user-select: none;">+1</span></button>
            <button id="pos_plus10"><span style="user-select: none;">+10</span></button>
            <button id="pos_plusInf"><span style="user-select: none;">+Inf</span></button>
        </div>
        <br/>
        <div id="quickInputBtn3">
            <button><span style="user-select: none;">/</span></button>
            <button><span style="user-select: none;">\</span></button>
            <button><span style="user-select: none;">:</span></button>
            <button><span style="user-select: none;">@</span></button>
            <button><span style="user-select: none;">%</span></button>
            <button><span style="user-select: none;">&</span></button>
            <button><span style="user-select: none;">?</span></button>
            <button><span style="user-select: none;">-</span></button>
            <button><span style="user-select: none;">_</span></button>
            <button><span style="user-select: none;">=</span></button>
            <button><span style="user-select: none;">.</span></button>
            <button><span style="user-select: none;">#</span></button>
        </div>
    </div>
    </div>

    <script>
    // 检测是否为电脑端
        function isDesktop() {
            return !/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }
        
        function isDesktopMove() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }
        
        // 页面加载时恢复保存的选择
        document.addEventListener('DOMContentLoaded', function() {
            const savedEngine = localStorage.getItem('selectedEngine');
            if (savedEngine) {
                document.getElementById('engineSelect').value = savedEngine;
            }
            // 如果保存的选择是customSearch，显示重新自定义按钮
            if (savedEngine === 'customSearch') {
                showCustomSearchButton();
            }
            // 如果保存的选择是iFrameFree，则显示iframe容器
            if (savedEngine === 'iFrameFree') {
                document.getElementById('iframeContainer').style.display = 'block';
            }
            if (isDesktopMove()) {
                if (savedEngine === 'baiduTw' || 
                    savedEngine === 'biliTv' || savedEngine === 'quarkpcAI' || savedEngine === 'showCheckbox') {
                    document.getElementById('submitBtn').disabled = true;
                }
            }
            if (isDesktop()) {
                if (savedEngine === 'sodouyinM' || savedEngine === 'yzmsmM' || savedEngine === 'sotoutiaoM' || savedEngine === 'baiduMEasy' || savedEngine === 'oldBaiduFanyi' || savedEngine === 'showCheckbox') {
                    document.getElementById('submitBtn').disabled = true;
                }
            }
            // 如果保存的选择是showCheckbox，则显示autoFillhttps div
            if (savedEngine === 'showCheckbox') {
                document.getElementById('autoFillhttps').style.display = 'block';
                document.getElementById('submitBtn').disabled = true;
                document.getElementById('urlInput').disabled = true;
                
                // 同时应用保存的布局状态
                const savedLayoutState = localStorage.getItem('layoutChecked');
                if (savedLayoutState === 'true') {
                    applyLayoutStyle(true);
                }
            }
            // 初始化用户输入状态
            if (document.getElementById('urlInput').value !== 'https://') {
                document.getElementById('urlInput').dataset.userInput = 'true';
            }
        });
        
        // 如果是电脑端，禁用移动搜索选项
            if (isDesktop()) {
                document.getElementById('douyinOption').disabled = true;
                document.getElementById('shenmaOption').disabled = true;
                document.getElementById('toutiaoOption').disabled = true;
                document.getElementById('baidueasyOption').disabled = true;
                document.getElementById('baiduFanyi').disabled = true;
            }
            
            if (isDesktopMove()) {
                document.getElementById('quarkaiOption').disabled = true;
                document.getElementById('baidutwOption').disabled = true;
                document.getElementById('bilibiliOption').disabled = true;
            }

        document.getElementById('submitBtn').addEventListener('click', function() {
            let url = document.getElementById('urlInput').value.trim();
            const engine = document.getElementById('engineSelect').value;
            
            // 保存当前选择
            localStorage.setItem('selectedEngine', engine);
            
            // 如果选择iFrameFree且输入了完整URL，直接在iframe中加载
            if (engine === 'iFrameFree' && url.includes('://')) {
                document.getElementById('webFrame').src = url;
                document.getElementById('iframeContainer').style.display = 'block';
                return; // 不执行后续跳转
            }
            
            // 如果保存输入文本复选框被勾选，保存当前输入
            if (document.getElementById('saveInputCheckbox').checked) {
                localStorage.setItem('savedInputText', document.getElementById('urlInput').value.trim());
            }
            
            if(url && !url.includes('://')) {
                // 根据选择的搜索引擎构建搜索URL
                switch(engine) {
                    case 'baidu':
                        url = 'https://www.baidu.com/s?wd=' + encodeURIComponent(url);
                        break;
                    case 'google':
                        url = 'https://www.google.com/search?q=' + encodeURIComponent(url);
                        break;
                    case 'bing':
                        url = 'https://www.bing.com/search?q=' + encodeURIComponent(url);
                        break;
                    case 'sogou':
                        url = 'https://www.sogou.com/web?query=' + encodeURIComponent(url);
                        break;
                    case 'so':
                        url = 'https://www.so.com/s?q=' + encodeURIComponent(url);
                        break;
                    case 'yandex':
                        url = 'https://yandex.com/search/?text=' + encodeURIComponent(url);
                        break;
                    case 'autofillHttp1':
                        // 自动填充http://前缀
                        url = 'http://' + url;
                        break;
                    case 'autofillHttps':
                        // 自动填充https://前缀
                        url = 'https://' + url;
                        break;
                    case 'newtabpageHttp1':
                        // 新建标签页处理
                        if (url) {
                            // 如果没有协议前缀，添加http://
                            if (!url.includes('://')) {
                                url = 'http://' + url;
                            }
                            window.open(url, '_blank');
                            return; // 直接返回，不执行下面的跳转
                        }
                        break;
                        case 'newtabpageHttps':
                        // 新建标签页处理
                        if (url) {
                            // 如果没有协议前缀，添加https://
                            if (!url.includes('://')) {
                                url = 'https://' + url;
                            }
                            window.open(url, '_blank');
                            return; // 直接返回，不执行下面的跳转
                        }
                        break;
                    case 'duckduckgo':
                        url = 'https://duckduckgo.com/?q=' + encodeURIComponent(url);
                        break;
                    case 'sodouyinM':
                        url = 'https://so.douyin.com/s?keyword=' + encodeURIComponent(url);
                        break;
                    case 'yzmsmM':
                        url = 'https://yz.m.sm.cn/s?q=' + encodeURIComponent(url);
                        break;
                    case 'sotoutiaoM':
                        url = 'https://so.toutiao.com/search?keyword=' + encodeURIComponent(url);
                        break;
                    case 'baiduMEasy':
                        url = 'https://m.baidu.com/from=1030335w/pu=sz%401321_1001/s?word=' + encodeURIComponent(url);
                        break;
                    case 'metasosuoAI':
                        url = 'https://metaso.cn/?s=nyzav&referrer_s=nyzav&q=' + encodeURIComponent(url);
                        break;
                    case 'baiduAI':
                        url = 'https://chat.baidu.com/search?word=' + encodeURIComponent(url);
                        break;
                    case '360namisoAI':
                        url = 'https://www.n.cn/?src=360ai_so&s_type=l&q=' + encodeURIComponent(url);
                        break;
                    case 'zhihuZhiDaAI':
                        url = 'https://zhida.zhihu.com/search?q=' + encodeURIComponent(url);
                        break;
                    case 'quarkpcAI':
                        url = 'https://ai.quark.cn/s?ch=pcquark%40homepage_quarkweb&q=' + encodeURIComponent(url) + '&frame_scene=deep_think_light_r1lite&by=deepthink_light';
                        break;
                    case 'googleTranslate':
                        url = 'https://translate.google.com/?sl=auto&tl=zh-CN&text=' + encodeURIComponent(url);
                        break;
                    case 'mcTranslator':
                        url = 'https://cn.bing.com/translator?ref=TThis&text=' + encodeURIComponent(url) + '&from=en&to=zh-Hans';
                        break;
                    case 'youdaoFanyi':
                        url = 'https://youdao.com/result?word=' + encodeURIComponent(url) + '&lang=en';
                        break;
                    case 'yandexTranslate':
                        url = 'https://translate.yandex.com/?source_lang=en&target_lang=zh&text=' + encodeURIComponent(url);
                        break;
                    case 'sogouFanyi':
                        url = 'https://fanyi.sogou.com/text?fr=default&keyword=' + encodeURIComponent(url);
                        break;
                    case 'oldBaiduFanyi':
                        url = 'https://fanyi.baidu.com/translate#auto/zh/' + encodeURIComponent(url);
                        break;
                    case 'fanyiSo':
                        url = 'https://fanyi.so.com/#' + encodeURIComponent(url);
                        break;
                    case 'deeplTranslator':
                        url = 'https://www.deepl.com/translator#en/zh/' + encodeURIComponent(url);
                        break;
                    case 'volcTranslate':
                        url = 'https://translate.volcengine.com/mobile?text=' + encodeURIComponent(url) + '&source_language=detect&target_language=zh&from=douyin';
                        break;
                    case 'nowTsAi':
                        url = 'https://www.aitranslatenow.com/zh/translate/en/zh#sourceText=' + encodeURIComponent(url);
                        break;
                    case 'githubCode':
                        url = 'https://github.com/search?q=' + encodeURIComponent(url);
                        break;
                    case 'baiduTw':
                        url = 'https://www.baidu.com/s?cl=3&tn=baidubig5&ie=utf8&wd=' + encodeURIComponent(url);
                        break;
                    case 'biliTv':
                        url = 'http://search.bilibili.com/all?keyword=' + encodeURIComponent(url);
                        break;
                    case 'showCheckbox':
                        url = 'https://www.baidu.com/s?wd=' + encodeURIComponent(url);
                        break;
                    case 'kfBaidu':
                        url = 'https://kaifa.baidu.com/searchPage?wd=' + encodeURIComponent(url);
                        break;
                    case 'customSearch':
                        const customSearchUrl = localStorage.getItem('customSearchUrl');
                        if (customSearchUrl) {
                            url = customSearchUrl.replace('{keywords}', encodeURIComponent(url));
                        } else {
                            // 如果没有设置自定义搜索网址，使用默认的百度搜索
                            url = 'https://www.baidu.com/s?wd=' + encodeURIComponent(url);
                        }
                        break;
                    case 'iFrameFree':
                        // 在iframe中加载网页
                        if(url && !url.includes('://')) {
                            url = 'https://' + url;
                        }
                        if(url) {
                            document.getElementById('webFrame').src = url;
                            document.getElementById('iframeContainer').style.display = 'block';
                        }
                        return; // 不执行页面跳转
                }
            } else if(url) {
                // 如果包含://，直接使用输入的URL
                // 无需修改
            }
            
            if(url) {
                // 对于新建标签页选项，如果输入为空则不执行任何操作
                if (engine === 'newtabpage' && !url) {
                    return;
                }
                window.location.href = url;
            }
        });
        // 重新自定义搜索网址文字点击事件
        document.querySelector('label[for="redefineSearchBtn"]').addEventListener('click', function() {
            const currentUrl = localStorage.getItem('customSearchUrl') || 'https://www.baidu.com/s?wd={keywords}';
            const newCustomSearchUrl = prompt('请输入新的自定义搜索网址（使用{keywords}作为搜索词占位符）：', currentUrl);
            
            if (newCustomSearchUrl !== null) { // 用户没有点击取消
                if (newCustomSearchUrl && newCustomSearchUrl.includes('{keywords}')) {
                    localStorage.setItem('customSearchUrl', newCustomSearchUrl);
                }
            }
            // 点击取消不做任何操作
        });
        
        // 监听选择变化并保存
        document.getElementById('engineSelect').addEventListener('change', function() {
            localStorage.setItem('selectedEngine', this.value);
            // 根据选择显示或隐藏 checkbox
            if (this.value === 'showCheckbox') {
                document.getElementById('autoFillhttps').style.display = 'block';
                submitBtn.disabled = true;
                urlInput.disabled = true;
            } else {
                document.getElementById('autoFillhttps').style.display = 'none';
                submitBtn.disabled = false;
                urlInput.disabled = false;
            }
            // 控制iframe显示
            if (this.value === 'iFrameFree') {
                document.getElementById('iframeContainer').style.display = 'block';
            } else {
                document.getElementById('iframeContainer').style.display = 'none';
            }
            // 根据选择显示或隐藏 checkbox
            if (this.value === 'showCheckbox') {
                document.getElementById('autoFillhttps').style.display = 'block';
                const savedLayoutState = localStorage.getItem('layoutChecked');
                if (savedLayoutState === 'true') {
                    applyLayoutStyle(true);
                }
            } else {
                document.getElementById('autoFillhttps').style.display = 'none';
                const savedLayoutState = localStorage.getItem('layoutChecked');
                if (savedLayoutState !== 'true') {
                    applyLayoutStyle(false);
                }
            }
            if (isDesktopMove()) {
                if (this.value === 'baiduTw' || 
                this.value === 'biliTv' || this.value === 'quarkpcAI' || this.value === 'showCheckbox') {
                document.getElementById('submitBtn').disabled = true;
            } else {
                document.getElementById('submitBtn').disabled = false;
                }
            }
            if (isDesktop()) {
                if (this.value === 'sodouyinM' || this.value === 'yzmsmM' || 
                this.value === 'sotoutiaoM' || this.value === 'baiduMEasy' || this.value === 'oldBaiduFanyi' || this.value === 'showCheckbox') {
                document.getElementById('submitBtn').disabled = true;
            } else {
                document.getElementById('submitBtn').disabled = false;
                }
            }
            if (this.value === 'showCheckbox') {
                document.getElementById('autoFillhttps').style.display = 'block';
                document.querySelector('label[for="bgColorPicker"]').style.display = 'inline-block';
            } else {
                document.getElementById('autoFillhttps').style.display = 'none';
                document.querySelector('label[for="bgColorPicker"]').style.display = 'none';
            }
            if (this.value === 'showCheckbox') {
                document.getElementById('autoFillhttps').style.display = 'block';
                document.querySelector('label[for="bgColorPicker"]').style.display = 'inline-block';
            } else {
                document.getElementById('autoFillhttps').style.display = 'none';
                document.querySelector('label[for="bgColorPicker"]').style.display = 'none';
            }
            if (this.value === 'showCheckbox') {
                document.getElementById('autoFillhttps').style.display = 'block';
                linkCreatorBtn.style.display = 'inline-block';
            } else {
                document.getElementById('autoFillhttps').style.display = 'none';
                linkCreatorBtn.style.display = 'none';
                document.getElementById('linkCreatorPanel').style.display = 'none';
            }
            // 无论选择什么，都更新快捷链接显示
            updateQuickLinks();
            const currentValue = this.value;
            localStorage.setItem('selectedEngine', currentValue);
            
            // 如果选择customSearch，检查是否已设置自定义搜索网址
            if (currentValue === 'customSearch') {
                const customSearchUrl = localStorage.getItem('customSearchUrl');
                if (!customSearchUrl) {
                    // 首次选择，提示输入自定义搜索网址
                    const newCustomSearchUrl = prompt('请输入自定义搜索网址（使用{keywords}作为搜索词占位符）：', 'https://www.baidu.com/s?wd={keywords}');
                    if (newCustomSearchUrl === null) {
                        // 用户点击取消，恢复之前的选择
                        const previousEngine = localStorage.getItem('previousEngine') || 'baidu';
                        this.value = previousEngine;
                        localStorage.setItem('selectedEngine', previousEngine);
                        return;
                    }
                    if (newCustomSearchUrl && newCustomSearchUrl.includes('{keywords}')) {
                        localStorage.setItem('customSearchUrl', newCustomSearchUrl);
                        showCustomSearchButton();
                    } else {
                        // 网址格式不正确，恢复之前的选择
                        const previousEngine = localStorage.getItem('previousEngine') || 'baidu';
                        this.value = previousEngine;
                        localStorage.setItem('selectedEngine', previousEngine);
                        return;
                    }
                } else {
                    showCustomSearchButton();
                }
            } else {
                // 保存当前选择作为previousEngine，用于customSearch取消时恢复
                localStorage.setItem('previousEngine', currentValue);
                hideCustomSearchButton();
            }
        });
        
        // 保存和加载focusCheckbox状态
        const savedFocusCheckboxState = localStorage.getItem('focusCheckboxChecked');
        if (savedFocusCheckboxState === 'true') {
            document.getElementById('focusCheckbox').checked = true;
            document.getElementById('quickInputCheckbox').disabled = false;
            // 监听输入框聚焦时的高度变化，调整quickInputUi位置
            document.getElementById('urlInput').addEventListener('focus', function() {
                adjustQuickInputPosition();
                document.body.classList.add('focused');
                document.querySelector('.search-container').classList.add('focused');
                document.getElementById('quickInputBtn').style.display = 'block';
                document.getElementById('iframeContainer').style.display = 'none';
                
                // 添加高度检测和间距调整
                const inputHeight = parseInt(getComputedStyle(this).height);
                const submitBtnHeight = parseInt(getComputedStyle(document.getElementById('submitBtn')).height);
                const maxHeight = Math.max(inputHeight, submitBtnHeight);
                
                if (maxHeight > 24) {
                    const extraSpace = maxHeight - 24;
                    document.getElementById('quickInputBtn').style.marginTop = (0 + extraSpace) + 'px';
                } else {
                    document.getElementById('quickInputBtn').style.marginTop = '0px';
                }
                
                // 检查是否启用了自动选择https文本功能
                const isSelectHttpsTextChecked = localStorage.getItem('selectHttpsTextChecked') === 'true';
                const isAutoFillHttpsChecked = localStorage.getItem('autoFillHttpsChecked') === 'true';
                
                // 只有当所有条件满足且用户没有手动输入时才自动选择
                if (isSelectHttpsTextChecked && isAutoFillHttpsChecked && 
                    this.value === 'https://' && !this.dataset.userInput) {
                    this.select(); // 自动选择所有文本
                }
            });
        }

        // 监听focusCheckbox变化
        document.getElementById('focusCheckbox').addEventListener('change', function() {
            localStorage.setItem('focusCheckboxChecked', this.checked);
            document.getElementById('quickInputCheckbox').disabled = !this.checked;
        });
        
        const urlInput = document.getElementById('urlInput');
        const quickInputBtn = document.getElementById('quickInputBtn');
        const buttons = quickInputBtn.querySelectorAll('button');
        
        // 为所有键盘按钮添加点击事件
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                const id = button.id; // 改为获取id
                
                // 处理光标位置按钮
                if (id.startsWith('pos_')) { // 改为判断id前缀
                    const currentPos = urlInput.selectionStart;
                    let newPos = currentPos;
            
                    if (id === 'pos_plus1') newPos = currentPos + 1; // 改为使用id判断
                    else if (id === 'pos_minus1') newPos = Math.max(0, currentPos - 1); // 改为使用id判断
                    else if (id === 'pos_plus10') newPos = currentPos + 10; // 改为使用id判断
                    else if (id === 'pos_minus10') newPos = Math.max(0, currentPos - 10); // 改为使用id判断
                    else if (id === 'pos_plusInf') newPos = urlInput.value.length; // 改为使用id判断
                    else if (id === 'pos_minusInf') newPos = 0; // 改为使用id判断
                    
                    // 设置新的光标位置
                    urlInput.setSelectionRange(newPos, newPos);
                } else {
                    const text = button.textContent; // 其他按钮仍然使用文本
                    
                    // 标记用户已经开始输入
                    urlInput.dataset.userInput = 'true';
                    
                    // 替换选中文本的逻辑
                    const selectionStart = urlInput.selectionStart;
                    const selectionEnd = urlInput.selectionEnd;
                    const currentValue = urlInput.value;
                    
                    // 如果有选中文本，则替换选中部分
                    if (selectionStart !== selectionEnd) {
                        urlInput.value = currentValue.substring(0, selectionStart) + text + currentValue.substring(selectionEnd);
                        // 将光标移动到插入文本之后
                        urlInput.setSelectionRange(selectionStart + text.length, selectionStart + text.length);
                    } else {
                        // 原有逻辑：在当前位置插入文本
                        urlInput.value = currentValue.substring(0, selectionStart) + text + currentValue.substring(selectionStart);
                        // 将光标移动到插入文本之后
                        urlInput.setSelectionRange(selectionStart + text.length, selectionStart + text.length);
                    }
                }
                urlInput.focus();
                // 如果保存输入文本复选框被勾选，保存当前输入
                if (document.getElementById('saveInputCheckbox').checked) {
                    localStorage.setItem('savedInputText', urlInput.value);
                }
            });
        });
        
        // 链接颜色控制
        document.querySelector('label[for="linkColorPicker"]').addEventListener('click', function() {
            const currentColor = localStorage.getItem('linkColor') || '#0000ee';
            const newColor = prompt('请输入链接颜色值（如 #0000ee 或 red）\n或者rgba(255,255,255,1.0)，rgb(255,255,255) ：', currentColor);
            
            if (newColor !== null) { // 用户没有点击取消
                if (newColor === '') {
                    // 输入为空时恢复默认颜色
                    const defaultColor = '#0000ee';
                    const linkElement = document.getElementById('85727544071588039023');
                    linkElement.style.color = defaultColor;
                    document.getElementById('linkColorValue').textContent = defaultColor;
                    localStorage.setItem('linkColor', defaultColor);
                } else if (/^#([0-9A-F]{3,6})$/i.test(newColor) || /^rgba?\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*(,\s*[\d.]+\s*)?\)$/i.test(newColor) || /^[a-z]+$/i.test(newColor)) {
                    const linkElement = document.getElementById('85727544071588039023');
                    linkElement.style.color = newColor;
                    document.getElementById('linkColorValue').textContent = newColor;
                    localStorage.setItem('linkColor', newColor);
                }
            }
        });
        
        // 加载保存的链接颜色
        const savedLinkColor = localStorage.getItem('linkColor');
        if (savedLinkColor) {
            const linkElement = document.getElementById('85727544071588039023');
            linkElement.style.color = savedLinkColor;
            document.getElementById('linkColorValue').textContent = savedLinkColor;
        }
        
        // 添加重命名功能
        document.querySelector('label[for="renameLinkBtn"]').addEventListener('click', function() {
            const linkElement = document.getElementById('85727544071588039023');
            const currentName = linkElement.textContent;
            const newName = prompt('请输入链接名称：', currentName);
            
            if (newName && newName.trim() !== '') {
                linkElement.textContent = newName.trim();
                document.getElementById('linkNameValue').textContent = newName.trim();
                localStorage.setItem('linkName', newName.trim());
            }
        });
        
        // 重置链接颜色和名称
        document.getElementById('resetLinkColorBtn').addEventListener('click', function() {
        if (confirm('确定要重置链接样式吗？')) {
                // 重置链接颜色
                const linkElement = document.getElementById('85727544071588039023');
                linkElement.style.color = '#0000ee';
                document.getElementById('linkColorValue').textContent = '#0000ee';
                localStorage.setItem('linkColor', '#0000ee');
                
                // 重置链接名称
                linkElement.textContent = 'Baidu.com';
                document.getElementById('linkNameValue').textContent = 'Baidu.com';
                localStorage.setItem('linkName', 'Baidu.com');
            }
        });
        
        // 加载保存的链接名称
        const savedLinkName = localStorage.getItem('linkName');
        if (savedLinkName) {
            const linkElement = document.getElementById('85727544071588039023');
            linkElement.textContent = savedLinkName;
            document.getElementById('linkNameValue').textContent = savedLinkName;
        }
        
        // 保存和加载quickInputCheckbox状态
        const savedQuickInputState = localStorage.getItem('quickInputChecked');
        if (savedQuickInputState === 'true') {
            document.getElementById('quickInputCheckbox').checked = true;
            document.getElementById('quickInputUi').style.display = 'block';
        }
        
        // 监听quickInputCheckbox变化
        document.getElementById('quickInputCheckbox').addEventListener('change', function() {
            localStorage.setItem('quickInputChecked', this.checked);
            if (this.checked) {
                document.getElementById('quickInputUi').style.display = 'block';
            } else {
                document.getElementById('quickInputUi').style.display = 'none';
            }
        });
        
        // 只有在focusCheckbox勾选时才添加focus/blur事件
        if (localStorage.getItem('focusCheckboxChecked') === 'true') {
            document.getElementById('urlInput').addEventListener('focus', function() {
                document.body.classList.add('focused');
                document.querySelector('.search-container').classList.add('focused');
                document.getElementById('quickInputBtn').style.display = 'block';
                document.getElementById('iframeContainer').style.display = 'none';
            });
            
            // 添加延迟恢复
            document.getElementById('urlInput').addEventListener('blur', function(e) {
                // 检查相关目标是否是quickInputBtn内的按钮
                var relatedTarget = e.relatedTarget;
                var isQuickInputBtnTarget = relatedTarget && 
                    (relatedTarget.parentNode && 
                     (relatedTarget.parentNode.id === 'quickInputBtn' || 
                     relatedTarget.parentNode.id === 'quickInputBtn1Head' ||
                      relatedTarget.parentNode.id === 'quickInputBtn2' || 
                      relatedTarget.parentNode.id === 'quickInputBtn3' ||
                      relatedTarget.parentNode.id === 'quickInputBtn4'));
                
                // 如果不是quickInputBtn内的按钮，才执行恢复操作
                if (!isQuickInputBtnTarget) {
                    // 添加延迟恢复
                    setTimeout(() => {
                        document.body.classList.remove('focused');
                        document.querySelector('.search-container').classList.remove('focused');
                        document.getElementById('quickInputBtn').style.display = 'none';
                        // 恢复iframe显示（仅在iFrameFree选中时）
                        if (document.getElementById('engineSelect').value === 'iFrameFree') {
                            document.getElementById('iframeContainer').style.display = 'block';
                        }
                    }, 100);
                }
            });
        }
        
        // 动态添加CSS样式
        const style = document.createElement('style');
        style.textContent = `
            .search-container.focused {
                position: fixed;
                top: 10px;
                left: 0;
                right: 0;
                width: 85%;
                z-index: 1000;
                margin: 0 auto;
                background: white;
            }
            
            body.focused #autoFillhttps,
            body.focused a {
                display: none !important;
            }
            
            body.focused #quickInputBtn {
                display: block !important;
                position: fixed;
                left: 0;
                right: 0;
                text-align: center;
                z-index: 1001;
                top: 60px;
            }
            
            /* 新增子容器横向排列样式 */
            body.focused #quickInputBtn > div {
                display: inline-block;
                white-space: nowrap;
            }
            
            body.focused #quickInputBtn1Head, #quickInputBtn2, #quickInputBtn3 {
                overflow-x: auto;
                white-space: nowrap;
                width: 95%;
            }
            
            body.focused #engineSelect {
                opacity: 0;
                width: 0;
                min-width: 0;
                margin: 0;
                padding: 0;
                border: none;
                overflow: hidden;
            }`;
        document.head.appendChild(style);
        
        // 监听布局复选框状态变化
        document.getElementById('layoutCheckbox').addEventListener('change', function() {
            localStorage.setItem('layoutChecked', this.checked);
            applyLayoutStyle(this.checked);
        });
        
        // 应用布局样式函数
        function applyLayoutStyle(checked) {
            if (checked) {
                document.body.style.textAlign = 'center';
                document.body.style.position = 'relative';
                document.body.style.top = '25%';
                document.body.style.height = '50%';
            } else {
                document.body.style.textAlign = '';
                document.body.style.position = '';
                document.body.style.top = '';
                document.body.style.height = '';
            }
        }
        
        // 添加urlInput的mousedown事件处理，用于取消自动选择
        document.getElementById('urlInput').addEventListener('mousedown', function() {
            // 检查是否启用了自动选择https文本功能
            const isSelectHttpsTextChecked = localStorage.getItem('selectHttpsTextChecked') === 'true';
            const isAutoFillHttpsChecked = localStorage.getItem('autoFillHttpsChecked') === 'true';
            
            // 只有当所有条件满足且用户没有手动输入时才处理
            if (isSelectHttpsTextChecked && isAutoFillHttpsChecked && 
                this.value === 'https://' && !this.dataset.userInput) {
                
                // 检查是否已经选择了文本
                const selectionStart = this.selectionStart;
                const selectionEnd = this.selectionEnd;
                
                if (selectionStart === 0 && selectionEnd === this.value.length) {
                    // 如果文本已经被全选，阻止默认的focus行为，取消选择
                    this.setSelectionRange(this.value.length, this.value.length);
                }
            }
        });

        // 加载保存的布局复选框状态
        const savedLayoutState = localStorage.getItem('layoutChecked');
        if (savedLayoutState === 'true') {
            document.getElementById('layoutCheckbox').checked = true;
            applyLayoutStyle(true);
        }
        
        // 保存和加载saveInputCheckbox状态
        const savedInputState = localStorage.getItem('saveInputChecked');
        if (savedInputState === 'true') {
            document.getElementById('saveInputCheckbox').checked = true;
            const savedInputText = localStorage.getItem('savedInputText');
            if (savedInputText) {
                document.getElementById('urlInput').value = savedInputText;
            }
        }
        
        // 监听saveInputCheckbox变化
        document.getElementById('saveInputCheckbox').addEventListener('change', function() {
            localStorage.setItem('saveInputChecked', this.checked);
            if (!this.checked) {
                localStorage.removeItem('savedInputText');
            }
        });
        
        // 监听复选框状态变化
        document.getElementById('customCheckbox').addEventListener('change', function() {
            localStorage.setItem('autoFillHttpsChecked', this.checked);
            
            // 控制selectHttpsText的disabled状态
            document.getElementById('selectHttpsText').disabled = !this.checked;
            
            if (this.checked) {
                // 只有当输入框为空时才自动填充
                if (!document.getElementById('urlInput').value.trim()) {
                    document.getElementById('urlInput').value = 'https://';
                    // 重置用户输入状态
                    document.getElementById('urlInput').dataset.userInput = '';
                }
            } else {
                document.getElementById('urlInput').value = '';
                // 重置用户输入状态
                document.getElementById('urlInput').dataset.userInput = '';
            }
        }); 
        // 监听selectHttpsText变化
        document.getElementById('selectHttpsText').addEventListener('change', function() {
            localStorage.setItem('selectHttpsTextChecked', this.checked);
        });
        
        // 加载保存的selectHttpsText状态
        const savedSelectHttpsTextState = localStorage.getItem('selectHttpsTextChecked');
        if (savedSelectHttpsTextState === 'true') {
            document.getElementById('selectHttpsText').checked = true;
        }
        
        // 添加urlInput的focus事件处理，用于自动选择https文本
        document.getElementById('urlInput').addEventListener('focus', function() {
            // 检查是否启用了自动选择https文本功能
            const isSelectHttpsTextChecked = localStorage.getItem('selectHttpsTextChecked') === 'true';
            const isAutoFillHttpsChecked = localStorage.getItem('autoFillHttpsChecked') === 'true';
            
            // 只有当所有条件满足且用户没有手动输入时才自动选择
            if (isSelectHttpsTextChecked && isAutoFillHttpsChecked && 
                this.value === 'https://' && !this.dataset.userInput) {
                this.select(); // 自动选择所有文本
            }
        });
        
        // 监听urlInput输入事件，当用户开始输入时记录状态
        document.getElementById('urlInput').addEventListener('input', function() {
            // 记录用户已经开始输入，禁用自动选择
            if (this.value !== 'https://') {
                this.dataset.userInput = 'true';
            }
            
            if (document.getElementById('saveInputCheckbox').checked) {
                localStorage.setItem('savedInputText', this.value);
            }
        });
        
        const savedEngine = localStorage.getItem('selectedEngine');
            if (savedEngine) {
            document.getElementById('engineSelect').value = savedEngine;
        }
        
        // 显示/隐藏链接的checkbox
        document.getElementById('showLinkCheckbox').addEventListener('change', function() {
            localStorage.setItem('showLinkChecked', this.checked);
            toggleLinkDisplay(this.checked);
        });
        
        // 加载保存的显示链接复选框状态
        const savedShowLinkState = localStorage.getItem('showLinkChecked');
        if (savedShowLinkState === 'true') {
            document.getElementById('showLinkCheckbox').checked = true;
            toggleLinkDisplay(true);
        } else if (savedShowLinkState === 'false') {
            document.getElementById('showLinkCheckbox').checked = false;
            toggleLinkDisplay(false);
        }
        
        // 切换链接显示状态的函数
        function toggleLinkDisplay(show) {
            const linkElement = document.getElementById('85727544071588039023');
            if (linkElement) {
                linkElement.style.display = show ? 'inline-block' : 'none';
            }
        }
        
        // 保存和加载showSendCheckbox状态
        const savedShowSendCheckboxState = localStorage.getItem('showSendCheckboxChecked');
        if (savedShowSendCheckboxState === 'true') {
            document.getElementById('showSendCheckbox').checked = true;
            document.getElementById('submitBtn').style.display = 'inline-block';
        } else if (savedShowSendCheckboxState === 'false') {
            document.getElementById('showSendCheckbox').checked = false;
            document.getElementById('submitBtn').style.display = 'none';
        }
        
        // 监听showSendCheckbox变化
        document.getElementById('showSendCheckbox').addEventListener('change', function() {
            localStorage.setItem('showSendCheckboxChecked', this.checked);
            if (this.checked) {
                document.getElementById('submitBtn').style.display = 'inline-block';
            } else {
                document.getElementById('submitBtn').style.display = 'none';
            }
        });
        
        // 保存和加载背景颜色
        const savedBgColor = localStorage.getItem('backgroundColor') || '#ffffff';
        document.body.style.backgroundColor = savedBgColor;
        document.getElementById('searchContainer').style.background = savedBgColor;
        document.getElementById('bgColorPicker').value = savedBgColor;
        document.getElementById('colorValue').textContent = savedBgColor;
        
        // 监听背景颜色变化
        document.getElementById('bgColorPicker').addEventListener('input', function() {
            const color = this.value;
            document.body.style.backgroundColor = color;
            document.getElementById('searchContainer').style.background = color;
            localStorage.setItem('backgroundColor', color);
        });
        
        // 点击label触发颜色输入提示
        document.querySelector('label[for="bgColorPicker"]').addEventListener('click', function() {
            const currentColor = localStorage.getItem('backgroundColor') || '#ffffff';
            const newColor = prompt('请输入颜色值（如 #ffffff 或 red）\n或者rgba(255,255,255,1.0)，rgb(255,255,255) ：', currentColor);
            
            if (newColor !== null) { // 用户没有点击取消
                if (newColor === '') {
                    // 输入为空时恢复默认颜色
                    const defaultColor = '#ffffff';
                    document.body.style.backgroundColor = defaultColor;
                    document.getElementById('searchContainer').style.background = defaultColor;
                    document.getElementById('colorValue').textContent = defaultColor;
                    localStorage.setItem('backgroundColor', defaultColor);
                } else if (/^#([0-9A-F]{3,6})$/i.test(newColor) || /^rgba?\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*(,\s*[\d.]+\s*)?\)$/i.test(newColor) || /^[a-z]+$/i.test(newColor)) {
                    document.body.style.backgroundColor = newColor;
                    document.getElementById('searchContainer').style.background = newColor;
                    document.getElementById('colorValue').textContent = newColor;
                    localStorage.setItem('backgroundColor', newColor);
                }
            }
        });
        
        // 加载保存的复选框状态
        const savedCheckboxState = localStorage.getItem('autoFillHttpsChecked');
        if (savedCheckboxState === 'true') {
            document.getElementById('customCheckbox').checked = true;
            // 如果勾选，自动填充 https:// 到输入框
            // 只有当输入框为空时才自动填充
            if (!document.getElementById('urlInput').value.trim()) {
                document.getElementById('urlInput').value = 'https://';
            }
            if (savedCheckboxState === 'true') {
                document.getElementById('selectHttpsText').disabled = false;
            }
        }
        
        // 超链接快捷跳转功能
        document.querySelector('label[for="linkCreatorBtn0"]').addEventListener('click', function() {
            document.getElementById('linkCreatorPanel').style.display = 'block';
            linkCreatorBtn.style.display = 'none';
        });

        document.querySelector('label[for="cancelLinkBtn"]').addEventListener('click', function() {
            document.getElementById('linkCreatorPanel').style.display = 'none';
            linkCreatorBtn.style.display = 'inline-block';
            document.getElementById('linkUrlInput').value = 'https://baidu.com';
            document.getElementById('linkTextInput').value = '快捷方式';
        });
        
        // 高度调整功能
        document.querySelector('label[for="heightPicker"]').addEventListener('click', function() {
            const currentHeight = localStorage.getItem('elementHeight') || '24px';
            const newHeight = prompt('请输入高度值（如 24px，输入为空时恢复默认）：', currentHeight);
            
            if (newHeight !== null) {
                if (newHeight === '') {
                    // 输入为空时恢复默认高度
                    const defaultHeight = '24px';
                    document.getElementById('engineSelect').style.height = defaultHeight;
                    document.getElementById('urlInput').style.height = defaultHeight;
                    document.getElementById('submitBtn').style.height = defaultHeight;
                    document.getElementById('heightValue').textContent = defaultHeight;
                    localStorage.setItem('elementHeight', defaultHeight);
                } else if (/^\d+(\.\d+)?px$/.test(newHeight)) {
                    document.getElementById('engineSelect').style.height = newHeight;
                    document.getElementById('urlInput').style.height = newHeight;
                    document.getElementById('submitBtn').style.height = newHeight;
                    document.getElementById('heightValue').textContent = newHeight;
                    localStorage.setItem('elementHeight', newHeight);
                }
            }
        });
        
        // 宽度调整功能
        document.querySelector('label[for="widthPicker"]').addEventListener('click', function() {
            const currentWidth = localStorage.getItem('buttonWidth') || 'Default';
            const newWidth = prompt('请输入按钮宽度值（如 50px，输入空值恢复默认）：', currentWidth === 'Default' ? '' : currentWidth);
            
            if (newWidth !== null) {
                if (newWidth === '') {
                    // 输入为空时恢复默认宽度
                    document.getElementById('submitBtn').style.width = '';
                    document.getElementById('widthValue').textContent = 'Default';
                    localStorage.setItem('buttonWidth', 'Default');
                } else if (/^\d+(\.\d+)?px$/.test(newWidth)) {
                    document.getElementById('submitBtn').style.width = newWidth;
                    document.getElementById('widthValue').textContent = newWidth;
                    localStorage.setItem('buttonWidth', newWidth);
                }
            }
        });
        
        // 加载保存的高度设置
        const savedHeight = localStorage.getItem('elementHeight');
        if (savedHeight) {
            document.getElementById('engineSelect').style.height = savedHeight;
            document.getElementById('urlInput').style.height = savedHeight;
            document.getElementById('submitBtn').style.height = savedHeight;
            document.getElementById('heightValue').textContent = savedHeight;
        }
        
        // 加载保存的宽度设置
        const savedWidth = localStorage.getItem('buttonWidth');
        if (savedWidth && savedWidth !== 'Default') {
            document.getElementById('submitBtn').style.width = savedWidth;
            document.getElementById('widthValue').textContent = savedWidth;
        }
        
        document.querySelector('label[for="createLinkBtn"]').addEventListener('click', function() {
            const url = document.getElementById('linkUrlInput').value.trim();
            const text = document.getElementById('linkTextInput').value.trim();
            
            if (!url || !text) {
                return;
            }
            
            // 验证格式
            if (!url.startsWith('https://') && !url.startsWith('http://') && !url.startsWith('#')) {
                return;
            }
            
            // 保存链接
            const links = JSON.parse(localStorage.getItem('quickLinks') || '[]');
            links.push({ url, text });
            localStorage.setItem('quickLinks', JSON.stringify(links));
            
            // 更新显示
            updateQuickLinks();
            
            // 重置界面
            document.getElementById('linkCreatorPanel').style.display = 'none';
            linkCreatorBtn.style.display = 'inline-block';
            document.getElementById('linkUrlInput').value = 'https://baidu.com';
            document.getElementById('linkTextInput').value = '快捷方式';
        });
        
        // 导出设置功能
        document.querySelector('label[for="exportSettingsBtn"]').addEventListener('click', function() {
            const settings = {
                autoFillHttpsChecked: localStorage.getItem('autoFillHttpsChecked') || 'false',
                focusCheckboxChecked: localStorage.getItem('focusCheckboxChecked') || 'false',
                layoutChecked: localStorage.getItem('layoutChecked') || 'false',
                showLinkChecked: localStorage.getItem('showLinkChecked') || 'true',
                showSendCheckboxChecked: localStorage.getItem('showSendCheckboxChecked') || 'true',
                backgroundColor: localStorage.getItem('backgroundColor') || '#ffffff',
                quickInputChecked: localStorage.getItem('quickInputChecked') || 'false',
                linkColor: localStorage.getItem('linkColor') || '#0000ee',
                linkName: localStorage.getItem('linkName') || 'Baidu.com',
                elementHeight: localStorage.getItem('elementHeight') || '24px',
                buttonWidth: localStorage.getItem('buttonWidth') || 'Default',
                saveInputChecked: localStorage.getItem('saveInputChecked') || 'false',
                savedInputText: localStorage.getItem('savedInputText') || '',
                iframeWidth: localStorage.getItem('iframeWidth') || '100%',
                iframeHeight: localStorage.getItem('iframeHeight') || '600px',
                customSearchUrl: localStorage.getItem('customSearchUrl') || 'https://www.baidu.com/s?wd={keywords}',
                quickLinks: localStorage.getItem('quickLinks') || '[]',
                selectHttpsTextChecked: localStorage.getItem('selectHttpsTextChecked') || 'false',
                selectedEngine: localStorage.getItem('selectedEngine') || 'baidu'
            };
            
            const jsonContent = JSON.stringify(settings, null, 2);
            const base64Content = btoa(unescape(encodeURIComponent(jsonContent)));
            const dataUrl = 'data:application/json;base64,' + base64Content;
            
            const a = document.createElement('a');
            a.href = dataUrl;
            a.download = 'search_settings.json';
            a.click();
        });
        
        // 导入设置功能
        document.querySelector('label[for="importSettingsBtn"]').addEventListener('click', function() {
            document.getElementById('importSettingsInput').click();
        });
        
        document.getElementById('importSettingsInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    const content = event.target.result;
                    const settings = JSON.parse(content);
                    
                    // 恢复所有设置到localStorage
                    Object.keys(settings).forEach(key => {
                if (settings[key] !== null) {
                            localStorage.setItem(key, settings[key]);
                        }
                    });
                    
                    // 重新加载页面应用设置
                    location.reload();
                } catch (error) {
                }
                e.target.value = '';
            };
            reader.readAsText(file);
        });

        // 更新快捷链接显示
        function updateQuickLinks() {
            const quickLinksDiv = document.getElementById('quickLinks');
            const links = JSON.parse(localStorage.getItem('quickLinks') || '[]');
            const isShowCheckbox = document.getElementById('engineSelect').value === 'showCheckbox';
            
            quickLinksDiv.innerHTML = '';
            
            // 添加防止链接变紫色的样式
            const style = document.createElement('style');
            style.textContent = `
                #quickLinks a:visited {
                    color: #0000ee !important;
                }
                #quickLinks a:active {
                    color: #ff0000 !important;
                }
            `;
            document.head.appendChild(style);
            
            if (links.length === 0) {
                quickLinksDiv.style.display = 'none';
                return;
            }
            
            quickLinksDiv.style.display = 'block';
            quickLinksDiv.style.textAlign = 'center';
            
            const container = document.createElement('div');
            container.style.display = 'flex';
            container.style.width = '100%';
            container.style.justifyContent = 'center';
            container.style.flexWrap = 'wrap';
            container.style.margin = '10px';
            container.style.left = '0';
            container.style.right = '0';
            container.style.margin = '0 auto';
            
            links.forEach((link, index) => {
                const linkElement = document.createElement('a');
                linkElement.href = link.url.startsWith('http') ? link.url : '#';
                linkElement.textContent = link.text;
                linkElement.style.margin = '0 5px';
                linkElement.target = '_blank';
                
                const linkContainer = document.createElement('div');
                linkContainer.style.display = 'flex';
                linkContainer.style.alignItems = 'center';
                
                // 只在showCheckbox时显示删除按钮
                if (isShowCheckbox) {
                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = '×';
                    deleteBtn.style.marginLeft = '5px';
                    deleteBtn.onclick = function(e) {
                        e.preventDefault();
                        const updatedLinks = links.filter((_, i) => i !== index);
                        localStorage.setItem('quickLinks', JSON.stringify(updatedLinks));
                        updateQuickLinks();
                    };
                    linkContainer.appendChild(linkElement);
                    linkContainer.appendChild(deleteBtn);
                } else {
                    linkContainer.appendChild(linkElement);
                }
                
                container.appendChild(linkContainer);
            });
            
            quickLinksDiv.appendChild(container);
        }
        
        // 导出链接功能
        document.querySelector('label[for="exportLinksBtn"]').addEventListener('click', function() {
            const links = JSON.parse(localStorage.getItem('quickLinks') || '[]');
            if (links.length === 0) {
                return;
            }
            
            let htmlContent = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>快捷链接备份</title></head><body><ul>';
            links.forEach(link => {
                htmlContent += `<li><a href="${link.url}" target="_blank">${link.text}</a></li>`;
            });
            htmlContent += '</ul></body></html>';
            
            // 使用 data URL base64 替换 Blob
            const base64Content = btoa(unescape(encodeURIComponent(htmlContent)));
            const dataUrl = 'data:text/html;base64,' + base64Content;
            
            const a = document.createElement('a');
            a.href = dataUrl;
            a.download = 'quick_links_backup.html';
            a.click();
        });
        
        // 导入链接功能
        document.querySelector('label[for="importLinksBtn"]').addEventListener('click', function() {
            document.getElementById('importFileInput').click();
        });
        
        document.getElementById('importFileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const content = event.target.result;
                const parser = new DOMParser();
                const doc = parser.parseFromString(content, 'text/html');
                const links = Array.from(doc.querySelectorAll('a')).map(a => ({
                    url: a.href,
                    text: a.textContent
                }));
                
                if (links.length > 0) {
                    const existingLinks = JSON.parse(localStorage.getItem('quickLinks') || '[]');
                    const mergedLinks = existingLinks.concat(links);
                    localStorage.setItem('quickLinks', JSON.stringify(mergedLinks));
                    updateQuickLinks();
                }
                e.target.value = '';
            };
            reader.readAsText(file);
        });
        
        // 清除所有快捷链接
        document.querySelector('label[for="clearLinksBtn"]').addEventListener('click', function() {
            if (confirm('确定要清空所有快捷链接吗？')) {
                localStorage.removeItem('quickLinks');
                updateQuickLinks();
            }
        });
       
        // 页面加载时更新快捷链接
        document.addEventListener('DOMContentLoaded', function() {
            updateQuickLinks();
        });
        
        document.getElementById('85727544071588039023').addEventListener('click', function(e) {
            e.preventDefault();
            
            // 检查是否已经点击过
            if (!localStorage.getItem('36156798756549916136')) {
                if (confirm('确定要跳转到百度吗？\n以后不再提示')) {
                window.location.href = 'https://www.baidu.com';
            }
                localStorage.setItem('36156798756549916136', 'true');
            }
        });
        
        document.querySelector('label[for="iframeRefreshBtn"]').addEventListener('click', function() {
            const iframe = document.getElementById('webFrame');
            iframe.src = iframe.src;
        });

        document.querySelector('label[for="iframeCloseBtn"]').addEventListener('click', function() {
            if (confirm('确定要关闭窗口吗？')) {
                document.getElementById('webFrame').src = 'about:blank';
            }
        });
        
        // iframe控制功能
        let iframeCount = 1;
        
        document.querySelector('label[for="resizeIframeWidthBtn"]').addEventListener('click', function() {
        // 获取当前宽度，如果没有则使用默认值
        const currentWidth = localStorage.getItem('iframeWidth') || '100%';
        const width = prompt('请输入窗口宽度（输入为空时恢复默认）:', currentWidth);
            if (width !== null) {
                if (width === '') {
                    // 输入为空时恢复默认宽度
                    const defaultWidth = '100%';
                    document.getElementById('webFrame').style.width = defaultWidth;
                    localStorage.setItem('iframeWidth', defaultWidth);
                } else {
                    document.getElementById('webFrame').style.width = width;
                    localStorage.setItem('iframeWidth', width);
                }
            }
        });
        
        document.querySelector('label[for="resizeIframeHeightBtn"]').addEventListener('click', function() {
            // 获取当前高度，如果没有则使用默认值
            const currentHeight = localStorage.getItem('iframeHeight') || '600px';
            const height = prompt('请输入窗口高度（输入为空时恢复默认）:', currentHeight);
            if (height !== null) {
                if (height === '') {
                    // 输入为空时恢复默认高度
                    const defaultHeight = '600px';
                    document.getElementById('webFrame').style.height = defaultHeight;
                    localStorage.setItem('iframeHeight', defaultHeight);
                } else {
                    document.getElementById('webFrame').style.height = height;
                    localStorage.setItem('iframeHeight', height);
                }
            }
        });
        
        // 加载保存的iframe大小
        const savedIframeWidth = localStorage.getItem('iframeWidth');
        const savedIframeHeight = localStorage.getItem('iframeHeight');
        if (savedIframeWidth && savedIframeHeight) {
            document.getElementById('webFrame').style.width = savedIframeWidth;
            document.getElementById('webFrame').style.height = savedIframeHeight;
        }
        
        function getBrowserInfo() {
            var userAgent = navigator.userAgent;
            var browserName;
            var version;
            
            // 检测浏览器类型和版本
            if (userAgent.indexOf("Firefox") > -1) {
                browserName = "Firefox";
                version = userAgent.match(/Firefox\/([0-9.]+)/)[1];
            } else if (userAgent.indexOf("Chrome") > -1) {
                browserName = "Chrome";
                version = userAgent.match(/Chrome\/([0-9.]+)/)[1];
            } else if (userAgent.indexOf("Safari") > -1) {
                browserName = "Safari";
                version = userAgent.match(/Version\/([0-9.]+)/)[1];
            } else if (userAgent.indexOf("Edge") > -1) {
                browserName = "Edge";
                version = userAgent.match(/Edge\/([0-9.]+)/)[1];
            } else if (userAgent.indexOf("MSIE") > -1 || userAgent.indexOf("Trident") > -1) {
                browserName = "Internet Explorer";
                version = userAgent.match(/(MSIE |rv:)([0-9.]+)/)[2];
            } else {
                browserName = "Unknown";
                version = "Unknown";
            }
            
            return {
                name: browserName,
                version: version
            };
        }
        
        // 页面加载完成后显示浏览器信息
        window.onload = function() {
            var browserInfo = getBrowserInfo();
            var displayElement = document.getElementById("browserInfo");
            displayElement.innerHTML = "浏览器: " + browserInfo.name + "<br>版本号: " + browserInfo.version;
        };
        
        // 支持按Enter键提交
        document.getElementById('urlInput').addEventListener('keypress', function(e) {
            if(e.key === 'Enter') {
                document.getElementById('submitBtn').click();
                if (this.value.trim() !== '') {
                    this.blur();
                }
            }
        });
    </script>
</body>
</html>